# Repositories for Charts used for Releases in this namespace
repositories:
  - name: graphops
    url: https://graphops.github.io/helm-charts
  - name: graph-node-chart-dev
    url: git+https://github.com/graphops/helm-charts@charts?ref=feature/graph-node

# Anchors for each default release definition, their default values, and any inner resources that are relevant
templates:
  launchpad-release-template-defaults: &launchpad-release-template-defaults
    namespace: indexer
    missingFileHandler: Warn
  launchpad-release-template-postgresql-cr: &launchpad-release-template-postgresql-cr
    <<: *launchpad-release-template-defaults
    chart: graphops/resource-injector
    version: 0.2.0
    valuesTemplate:
      - &launchpad-default-release-values-postgresql-cr
        resources:
          postgres-cr: &launchpad-default-release-values-postgresql-cr-resource
            apiVersion: "acid.zalan.do/v1"
            kind: postgresql
            metadata:
              name: pg-graph-node
            spec:
              teamId: "pg"
              numberOfInstances: 1
              users:
                graph:
                  - superuser
              enableMasterLoadBalancer: false
              enableReplicaLoadBalancer: false
              enableConnectionPooler: false # enable/disable connection pooler deployment
              enableReplicaConnectionPooler: false # set to enable connectionPooler for replica service
              databases:
                graph: graph
              postgresql:
                version: "14"
                parameters: {}
              volume:
                size: 8Gi
                storageClass: openebs-hostpath
              resources:
                requests:
                  cpu: 100m
                  memory: 2Gi
                limits:
                  cpu: 1000m
                  memory: 4Gi
              patroni:
                initdb:
                  encoding: "UTF8"
                  locale: "C" # Improves performance and important for determinism
                  data-checksums: "true"

  launchpad-release-template-graph-node: &launchpad-release-template-graph-node
    <<: *launchpad-release-template-defaults
    chart: graph-node-chart-dev/graph-node
    # version: 4.2.1
    valuesTemplate:
      - &launchpad-default-release-values-graph-node {}
